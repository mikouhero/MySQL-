# 11 | 怎么给字符串字段加索引？

## 1、直接对字段添加完整索引
> 1、从索引树上找到满足条件的索引的这条记录，拿到ID   
> 2、到主键上查到主键值是 ID的行，判断 条件 的值是否正确,将记录加入结果集  
> 3、继续 不满足 结束循环  
- 这个过程中 需要回主键索引取一次数据，所以系统认为只扫描了一行 
- 比较占用空间 

## 2、创建前缀索引，
>1、 从索引书上查找满足条件的前缀索引记录 ，ID1  
>2、到主键上查到主键值是 ID1的行，判断 条件 的值是否正确,将记录加入结果集  
>3、继续从索引书上查找下一条索引记录，判断传，重复  。。
>4、 重复上一步，直到在 索引树 上取到的值不是该条件  结束

- 节省空间 ，又不用额外增加太多的查询成本
- 增加查询扫描次数，并且不能使用覆盖索引
 
## 3、使用什么语句可以分析不同长度前缀的索引区分度是多少?
```html
select count(distinct left(字段,长度）  as from tabel ;
``` 
当然，使用前缀索引很可能会损失区分度，所以你需要预先设定一个可以接受的损失比例



## 4、倒序存储，再创建前缀索引

-  用于绕过字符串本身前缀的区分度不够的问题(身份证号)
-  不支持范围扫描



## 5、创建 hash 字段索引 

- 查询性能稳定，有额外的存储和计算消耗
- 不支持范围扫描 

## 6、采用反序存储和hash字段作为索引有什么异同点?

>1、 从占用额外空间来看,倒序存储方式在主键索引上，不会消耗额外的存储空间，而hash 字段需要增加一个新的额字段，如果倒序存储的前缀长度过长，这个消耗就和hash字段等同  
>2、 在CPU 消耗方面，倒序方式每次读写都需要额外调用一次reverse函数，而hash  字段的方式需要额外调用crc32（）函数，从复杂度上来看，reverse函数消耗的CPU 资源更小  
>3、从查询效率上看，使用hash字段查询方式的查询性能相对更稳定一点，crc32()算出来的值虽然有冲突的概率，但是概率很小，可以认为每次查询的平均扫描行数接近于1 。而倒序存储方式毕竟还是用前缀索引的方式，会增加扫描行数  


